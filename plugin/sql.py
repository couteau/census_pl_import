
from .import_utils import GeographyType

pop_apblack_expr = "p0010004 + p0010011 + p0010016 + p0010017 + p0010018 + p0010019 + p0010027 + p0010028 + p0010029 + p0010030 + p0010037 + p0010038 + p0010039 + p0010040 + p0010041 + p0010042 + p0010048 + p0010049 + p0010050 + p0010051 + p0010052 + p0010053 + p0010058 + p0010059 + p0010060 + p0010061 + p0010064 + p0010065 + p0010066 + p0010067 + p0010069 + p0010071"
pop_apamind_aknative_expr = "p0010005 + p0010012 + p0010016 + p0010020 + p0010021 + p0010022 + p0010027 + p0010031 + p0010032 + p0010033 + p0010037 + p0010038 + p0010039 + p0010043 + p0010044 + p0010045 + p0010048 + p0010049 + p0010050 + p0010054 + p0010055 + p0010056 + p0010058 + p0010059 + p0010060 + p0010062 + p0010064 + p0010065 + p0010066 + p0010068 + p0010069 + p0010071"
pop_apasian_expr = "p0010006 + p0010013 + p0010017 + p0010020 + p0010023 + p0010024 + p0010028 + p0010031 + p0010034 + p0010035 + p0010037 + p0010040 + p0010041 + p0010043 + p0010044 + p0010046 + p0010048 + p0010051 + p0010052 + p0010054 + p0010055 + p0010057 + p0010058 + p0010059 + p0010061 + p0010062 + p0010064 + p0010065 + p0010067 + p0010068 + p0010069 + p0010071"
pop_aphawaii_pi_expr = "p0010007 + p0010014 + p0010018 + p0010021 + p0010023 + p0010025 + p0010029 + p0010032 + p0010034 + p0010036 + p0010038 + p0010040 + p0010042 + p0010043 + p0010045 + p0010046 + p0010049 + p0010051 + p0010053 + p0010054 + p0010056 + p0010057 + p0010058 + p0010060 + p0010061 + p0010062 + p0010064 + p0010066 + p0010067 + p0010068 + p0010069 + p0010071"

pop_nh_apblack_expr = "p0020006 + p0020013 + p0020018 + p0020019 + p0020020 + p0020021 + p0020029 + p0020030 + p0020031 + p0020032 + p0020039 + p0020040 + p0020041 + p0020042 + p0020043 + p0020044 + p0020050 + p0020051 + p0020052 + p0020053 + p0020054 + p0020055 + p0020060 + p0020061 + p0020062 + p0020063 + p0020066 + p0020067 + p0020068 + p0020069 + p0020071 + p0020073"
pop_nh_apamind_aknative_expr = "p0020007 + p0020014 + p0020018 + p0020022 + p0020023 + p0020024 + p0020029 + p0020033 + p0020034 + p0020035 + p0020039 + p0020040 + p0020041 + p0020045 + p0020046 + p0020047 + p0020050 + p0020051 + p0020052 + p0020056 + p0020057 + p0020058 + p0020060 + p0020061 + p0020062 + p0020064 + p0020066 + p0020067 + p0020068 + p0020070 + p0020071 + p0020073"
pop_nh_apasian_expr = "p0020008 + p0020015 + p0020019 + p0020022 + p0020025 + p0020026 + p0020030 + p0020033 + p0020036 + p0020037 + p0020039 + p0020042 + p0020043 + p0020045 + p0020046 + p0020048 + p0020050 + p0020053 + p0020054 + p0020056 + p0020057 + p0020059 + p0020060 + p0020061 + p0020063 + p0020064 + p0020066 + p0020067 + p0020069 + p0020070 + p0020071 + p0020073"
pop_nh_aphawaii_pi_expr = "p0020009 + p0020016 + p0020020 + p0020023 + p0020025 + p0020027 + p0020031 + p0020034 + p0020036 + p0020038 + p0020040 + p0020042 + p0020044 + p0020045 + p0020047 + p0020048 + p0020051 + p0020053 + p0020055 + p0020056 + p0020058 + p0020059 + p0020060 + p0020062 + p0020063 + p0020064 + p0020066 + p0020068 + p0020069 + p0020070 + p0020071 + p0020073"

vap_apblack_expr = "p0030004 + p0030011 + p0030016 + p0030017 + p0030018 + p0030019 + p0030027 + p0030028 + p0030029 + p0030030 + p0030037 + p0030038 + p0030039 + p0030040 + p0030041 + p0030042 + p0030048 + p0030049 + p0030050 + p0030051 + p0030052 + p0030053 + p0030058 + p0030059 + p0030060 + p0030061 + p0030064 + p0030065 + p0030066 + p0030067 + p0030069 + p0030071"
vap_multiracial_black_expr = "p0030011 + p0030016 + p0030017 + p0030018 + p0030019 + p0030027 + p0030028 + p0030029 + p0030030 + p0030037 + p0030038 + p0030039 + p0030040 + p0030041 + p0030042 + p0030048 + p0030049 + p0030050 + p0030051 + p0030052 + p0030053 + p0030058 + p0030059 + p0030060 + p0030061 + p0030064 + p0030065 + p0030066 + p0030067 + p0030069 + p0030071"
vap_black_white_expr = "p0030004 + P0030011"
vap_apamind_aknative_expr = "p0030005 + p0030012 + p0030016 + p0030020 + p0030021 + p0030022 + p0030027 + p0030031 + p0030032 + p0030033 + p0030037 + p0030038 + p0030039 + p0030043 + p0030044 + p0030045 + p0030048 + p0030049 + p0030050 + p0030054 + p0030055 + p0030056 + p0030058 + p0030059 + p0030060 + p0030062 + p0030064 + p0030065 + p0030066 + p0030068 + p0030069 + p0030071"
vap_apasian_expr = "p0030006 + p0030013 + p0030017 + p0030020 + p0030023 + p0030024 + p0030028 + p0030031 + p0030034 + p0030035 + p0030037 + p0030040 + p0030041 + p0030043 + p0030044 + p0030046 + p0030048 + p0030051 + p0030052 + p0030054 + p0030055 + p0030057 + p0030058 + p0030059 + p0030061 + p0030062 + p0030064 + p0030065 + p0030067 + p0030068 + p0030069 + p0030071"
vap_aphawaii_pi_expr = "p0030007 + p0030014 + p0030018 + p0030021 + p0030023 + p0030025 + p0030029 + p0030032 + p0030034 + p0030036 + p0030038 + p0030040 + p0030042 + p0030043 + p0030045 + p0030046 + p0030049 + p0030051 + p0030053 + p0030054 + p0030056 + p0030057 + p0030058 + p0030060 + p0030061 + p0030062 + p0030064 + p0030066 + p0030067 + p0030068 + p0030069 + p0030071"

vap_nh_apblack_expr = "p0040006 + p0040013 + p0040018 + p0040019 + p0040020 + p0040021 + p0040029 + p0040030 + p0040031 + p0040032 + p0040039 + p0040040 + p0040041 + p0040042 + p0040043 + p0040044 + p0040050 + p0040051 + p0040052 + p0040053 + p0040054 + p0040055 + p0040060 + p0040061 + p0040062 + p0040063 + p0040066 + p0040067 + p0040068 + p0040069 + p0040071 + p0040073"
vap_nh_black_white_expr = "p0040006 + p0040013"
vap_nh_multiracial_black_expr = "p0040013 + p0040018 + p0040019 + p0040020 + p0040021 + p0040029 + p0040030 + p0040031 + p0040032 + p0040039 + p0040040 + p0040041 + p0040042 + p0040043 + p0040044 + p0040050 + p0040051 + p0040052 + p0040053 + p0040054 + p0040055 + p0040060 + p0040061 + p0040062 + p0040063 + p0040066 + p0040067 + p0040068 + p0040069 + p0040071 + p0040073"
vap_nh_apamind_aknative_expr = "p0040007 + p0040014 + p0040018 + p0040022 + p0040023 + p0040024 + p0040029 + p0040033 + p0040034 + p0040035 + p0040039 + p0040040 + p0040041 + p0040045 + p0040046 + p0040047 + p0040050 + p0040051 + p0040052 + p0040056 + p0040057 + p0040058 + p0040060 + p0040061 + p0040062 + p0040064 + p0040066 + p0040067 + p0040068 + p0040070 + p0040071 + p0040073"
vap_nh_apasian_expr = "p0040008 + p0040015 + p0040019 + p0040022 + p0040025 + p0040026 + p0040030 + p0040033 + p0040036 + p0040037 + p0040039 + p0040042 + p0040043 + p0040045 + p0040046 + p0040048 + p0040050 + p0040053 + p0040054 + p0040056 + p0040057 + p0040059 + p0040060 + p0040061 + p0040063 + p0040064 + p0040066 + p0040067 + p0040069 + p0040070 + p0040071 + p0040073"
vap_nh_aphawaii_pi_expr = "p0040009 + p0040016 + p0040020 + p0040023 + p0040025 + p0040027 + p0040031 + p0040034 + p0040036 + p0040038 + p0040040 + p0040042 + p0040044 + p0040045 + p0040047 + p0040048 + p0040051 + p0040053 + p0040055 + p0040056 + p0040058 + p0040059 + p0040060 + p0040062 + p0040063 + p0040064 + p0040066 + p0040068 + p0040069 + p0040070 + p0040071 + p0040073"


pop_fields = """
    p0010001 AS pop_total,
    p0010003 AS pop_white,
    p0010004 AS pop_black,
    {pop_apblack_expr} AS pop_apblack,
    p0010005 AS pop_amind_aknative,
    {pop_apamind_aknative_expr} AS pop_apamind_aknative,
    p0010006 AS pop_asian,
    {pop_apasian_expr} AS pop_apasian,
    p0010007 AS pop_hawaii_pi,
    {pop_aphawaii_pi_expr} AS pop_aphawaii_pi,
    p0010008 AS pop_other_single_race,
	p0010009 AS pop_multiracial,
    p0020002 AS pop_hispanic,
    p0020005 AS pop_nh_white,
    p0020006 AS pop_nh_black,
    {pop_nh_apblack_expr} AS pop_nh_apblack,
    p0020007 AS pop_nh_amind_aknative,
    {pop_nh_apamind_aknative_expr} AS pop_nh_apamind_aknative,
    p0020008 AS pop_nh_asian,
    {pop_nh_apasian_expr} AS pop_nh_apasian,
    p0020009 AS pop_nh_hawaii_pi,
    {pop_nh_aphawaii_pi_expr} AS pop_nh_aphawaii_pi,
    p0020010 AS pop_nh_other_single_race,
    p0020011 AS pop_nh_multiracial,
    p0030001 AS vap_total,
    p0030003 AS vap_white,
    p0030004 AS vap_black,
    {vap_apblack_expr} AS vap_apblack,
    {vap_multiracial_black_expr} AS vap_multiracial_black,
    {vap_black_white_expr} AS vap_black_black_white,
    p0030005 AS vap_amind_aknative,
    {vap_apamind_aknative_expr} AS vap_apamind_aknative,
    p0030006 AS vap_asian,
    {vap_apasian_expr} AS vap_apasian,
    p0030007 AS vap_hawaii_pi,
    {vap_aphawaii_pi_expr} AS vap_aphawaii_pi,
    p0030008 AS vap_other_single_race,
	p0030009 AS vap_multiracial,
    p0040002 AS vap_hispanic,
    p0040005 AS vap_nh_white,
    p0040006 AS vap_nh_black,
    {vap_nh_apblack_expr} AS vap_nh_apblack,
    {vap_nh_black_white_expr} AS vap_nh_black_white,
    {vap_nh_multiracial_black_expr} AS vap_nh_multiracial_black,
    p0040007 AS vap_nh_amind_aknative,
    {vap_nh_apamind_aknative_expr} AS vap_nh_apamind_aknative,
    p0040008 AS vap_nh_asian,
    {vap_nh_apasian_expr} AS vap_nh_apasian,
    p0040009 AS vap_nh_hawaii_pi,
    {vap_nh_aphawaii_pi_expr} AS vap_nh_aphawaii_pi,
    p0040010 AS vap_nh_other_single_race,
    p0040011 AS vap_nh_multiracial,
    p0050001 AS pop_group_quarters_total,
    p0050003 AS pop_correctional,
    p0050004 AS pop_juvenile,
    p0050005 AS pop_nursing,
    p0050006 AS pop_other_inst,
    p0050008 AS pop_university,
    p0050009 AS pop_military,
    p0050010 AS pop_other_noninst,
    CAST(p0010003 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_white,
    CAST(p0010004 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_black,
    CAST({pop_apblack_expr} AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_apblack,
    CAST(p0010005 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_amind_aknative,
    CAST({pop_apamind_aknative_expr} AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_apamind_aknative,
    CAST(p0010006 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_asian,
    CAST({pop_apasian_expr} AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_apasian,
    CAST(p0010007 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_hawaii_pi,
    CAST({pop_aphawaii_pi_expr} AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_aphawaii_pi,
    CAST(p0010008 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_other_single_race,
    CAST(p0010009 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_multiracial,
    CAST(p0020002 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_hispanic,
    CAST(p0020005 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_white,
    CAST(p0020006 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_black,
    CAST({pop_nh_apblack_expr} AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_apblack,
    CAST(p0020007 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_amind_aknative,
    CAST({pop_nh_apamind_aknative_expr} AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_apamind_aknative,
    CAST(p0020008 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_asian,
    CAST({pop_nh_apasian_expr} AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_apasian,
    CAST(p0020009 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_hawaii_pi,
    CAST({pop_nh_aphawaii_pi_expr} AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_aphawaii_pi,
    CAST(p0020010 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_other_single_race,
    CAST(p0020011 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nh_multiracial,
    CAST(p0030003 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_white,
    CAST(p0030004 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_black,
    CAST({vap_apblack_expr} AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_apblack,
    CAST(p0030005 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_amind_aknative,
    CAST({vap_apamind_aknative_expr} AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_apamind_aknative,
    CAST(p0030006 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_asian,
    CAST({vap_apasian_expr} AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_apasian,
    CAST(p0030007 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_hawaii_pi,
    CAST({vap_aphawaii_pi_expr} AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_aphawaii_pi,
    CAST(p0030008 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_other_single_race,
    CAST(p0030009 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_multiracial,
    CAST(p0040002 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_hispanic,
    CAST(p0040005 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_white,
    CAST(p0040006 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_black,
    CAST({vap_nh_apblack_expr} AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_apblack,
    CAST(p0040007 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_amind_aknative,
    CAST({vap_nh_apamind_aknative_expr} AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_apamind_aknative,
    CAST(p0040008 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_asian,
    CAST({vap_nh_apasian_expr} AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_apasian,
    CAST(p0040009 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_hawaii_pi,
    CAST({vap_nh_aphawaii_pi_expr} AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_aphawaii_pi,
    CAST(p0040010 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_other_single_race,
    CAST(p0040011 AS NUMERIC) / NULLIF(p0030001,0) AS pct_vap_nh_multiracial,
    CAST(p0050001 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_group_quarters_total,
    CAST(p0050003 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_correctional,
    CAST(p0050004 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_juvenile,
    CAST(p0050005 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_nursing,
    CAST(p0050006 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_other_inst,
    CAST(p0050008 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_university,
    CAST(p0050009 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_military,
    CAST(p0050010 AS NUMERIC) / NULLIF(p0010001,0) AS pct_pop_other_noninst
"""

default_pop_fields = pop_fields.format(
    pop_apblack_expr=pop_apblack_expr,
    pop_apamind_aknative_expr=pop_apamind_aknative_expr,
    pop_apasian_expr=pop_apasian_expr,
    pop_aphawaii_pi_expr=pop_aphawaii_pi_expr,
    pop_nh_apblack_expr=pop_nh_apblack_expr,
    pop_nh_apamind_aknative_expr=pop_nh_apamind_aknative_expr,
    pop_nh_apasian_expr=pop_nh_apasian_expr,
    pop_nh_aphawaii_pi_expr=pop_nh_aphawaii_pi_expr,
    vap_apblack_expr=vap_apblack_expr,
    vap_multiracial_black_expr=vap_multiracial_black_expr,
    vap_black_white_expr=vap_black_white_expr,
    vap_apamind_aknative_expr=vap_apamind_aknative_expr,
    vap_apasian_expr=vap_apasian_expr,
    vap_aphawaii_pi_expr=vap_aphawaii_pi_expr,
    vap_nh_apblack_expr=vap_nh_apblack_expr,
    vap_nh_black_white_expr=vap_nh_black_white_expr,
    vap_nh_multiracial_black_expr=vap_nh_multiracial_black_expr,
    vap_nh_apamind_aknative_expr=vap_nh_apamind_aknative_expr,
    vap_nh_apasian_expr=vap_nh_apasian_expr,
    vap_nh_aphawaii_pi_expr=vap_nh_aphawaii_pi_expr
)

cvap_fields = """
    cvap_tot{acs_shortyear} AS cvap_{acs_longyear}_total,
    cvap_nhs{acs_shortyear} AS cvap_{acs_longyear}_nonhispanic,
    cvap_hsp{acs_shortyear} AS cvap_{acs_longyear}_hispanic,
    cvap_aia{acs_shortyear} AS cvap_{acs_longyear}_amind_aknative,
    cvap_asn{acs_shortyear} AS cvap_{acs_longyear}_asian,
    cvap_blk{acs_shortyear} AS cvap_{acs_longyear}_black,
    cvap_nhp{acs_shortyear} AS cvap_{acs_longyear}_hawaii_pi,
    cvap_wht{acs_shortyear} AS cvap_{acs_longyear}_nh_white,
    cvap_aiw{acs_shortyear} AS cvap_{acs_longyear}_amind_aknative_white,
    cvap_asw{acs_shortyear} AS cvap_{acs_longyear}_asian_white,
    cvap_blw{acs_shortyear} AS cvap_{acs_longyear}_black_white,
    cvap_aib{acs_shortyear} AS cvap_{acs_longyear}_amind_aknative_black,
    c_tot{acs_shortyear} AS cpop_{acs_longyear}_total,
    c_nhs{acs_shortyear} AS cpop_{acs_longyear}_nonhispanic,
    c_hsp{acs_shortyear} AS cpop_{acs_longyear}_hispanic,
    c_aia{acs_shortyear} AS cpop_{acs_longyear}_amind_aknative,
    c_asn{acs_shortyear} AS cpop_{acs_longyear}_asian,
    c_blk{acs_shortyear} AS cpop_{acs_longyear}_black,
    c_nhp{acs_shortyear} AS cpop_{acs_longyear}_hawaii_pi,
    c_wht{acs_shortyear} AS cpop_{acs_longyear}_nh_white,
    c_aiw{acs_shortyear} AS cpop_{acs_longyear}_amind_aknative_white,
    c_asw{acs_shortyear} AS cpop_{acs_longyear}_asian_white,
    c_blw{acs_shortyear} AS cpop_{acs_longyear}_black_white,
    c_aib{acs_shortyear} AS cpop_{acs_longyear}_amind_aknative_black,
    CAST(cvap_nhs{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_nonhispanic,
    CAST(cvap_hsp{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_hispanic,
    CAST(cvap_aia{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_amind_aknative,
    CAST(cvap_asn{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_asian,
    CAST(cvap_blk{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_black,
    CAST(cvap_nhp{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_hawaii_pi,
    CAST(cvap_wht{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_nh_white,
    CAST(cvap_aiw{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_amind_aknative_white,
    CAST(cvap_asw{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_asian_white,
    CAST(cvap_blw{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_black_white,
    CAST(cvap_aib{acs_shortyear} AS NUMERIC) / NULLIF(CAST(cvap_tot{acs_shortyear} AS NUMERIC),0) AS pct_cvap_{acs_longyear}_amind_aknative_black,
    CAST(c_nhs{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_nonhispanic,
    CAST(c_hsp{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_hispanic,
    CAST(c_aia{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_amind_aknative,
    CAST(c_asn{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_asian,
    CAST(c_blk{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_black,
    CAST(c_nhp{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_hawaii_pi,
    CAST(c_wht{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_nh_white,
    CAST(c_aiw{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_amind_aknative_white,
    CAST(c_asw{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_asian_white,
    CAST(c_blw{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_black_white,
    CAST(c_aib{acs_shortyear} AS NUMERIC) / NULLIF(CAST(c_tot{acs_shortyear} AS NUMERIC),0) AS pct_cpop_{acs_longyear}_amind_aknative_black
"""

block_fields = """
    pl.statefp{pl_shortyear},
    pl.countyfp{pl_shortyear},
    pl.tractce{pl_shortyear},
    pl.blockce{pl_shortyear},
    pl.blkgrp,
    pl.vtd,
    pl.cousub,
    pl.place
"""

vtd_fields = """
    pl.statefp{pl_shortyear},
    pl.countyfp{pl_shortyear},
    pl.vtdst{pl_shortyear},
    pl.vtdi{pl_shortyear},
    pl.name{pl_shortyear}
"""

county_fields = """
    pl.statefp{pl_shortyear},
    pl.countyfp{pl_shortyear},
    pl.name{pl_shortyear}
"""

tract_fields = """
    pl.statefp{pl_shortyear},
    pl.countyfp{pl_shortyear},
    pl.tractce{pl_shortyear},
    pl.name{pl_shortyear}
"""

blkgrp_fields = """
    pl.statefp{pl_shortyear},
    pl.countyfp{pl_shortyear},
    pl.tractce{pl_shortyear},
    pl.blkgrpce{pl_shortyear}
"""

geo_field = "geom"


def select_sql(geo_type: GeographyType, geoid_field, pl_layer, pl_year, acs_layer='', acs_year=0):
    if geo_type == GeographyType.BLOCK:
        fields = block_fields
    elif geo_type == GeographyType.VTD:
        fields = vtd_fields
    elif geo_type == GeographyType.COUNTY:
        fields = county_fields
    elif geo_type == GeographyType.BLKGRP:
        fields = blkgrp_fields
    elif geo_type == GeographyType.TRACT:
        fields = tract_fields
    else:
        fields = 'pl.statefp{pl_shortyear}, pl.name{pl_shortyear}'

    fields = f'{fields}, {default_pop_fields}'
    frm = f'FROM {pl_layer} pl'

    if acs_layer and acs_year:
        fields = f'{fields}, {cvap_fields}'
        frm = f'{frm} LEFT JOIN {acs_layer} cvap ON cvap.{geoid_field} = pl.{geoid_field}'

    select = f'SELECT pl.fid, pl.{geoid_field}, {fields}, pl.{geo_field} {frm}'
    return select.format(pl_shortyear=str(pl_year)[2:], acs_shortyear=str(acs_year)[2:], acs_longyear=str(acs_year))


pop_create_fields = """
    pop_total INTEGER,
    pop_white INTEGER,
    pop_black INTEGER,
    pop_apblack INTEGER,
    pop_amind_aknative INTEGER,
    pop_apamind_aknative INTEGER,
    pop_asian INTEGER,
    pop_apasian INTEGER,
    pop_hawaii_pi INTEGER,
    pop_aphawaii_pi INTEGER,
    pop_other_single_race INTEGER,
	pop_multiracial INTEGER,
    pop_hispanic INTEGER,
    pop_nh_white INTEGER,
    pop_nh_black INTEGER,
    pop_nh_apblack INTEGER,
    pop_nh_amind_aknative INTEGER,
    pop_nh_apamind_aknative INTEGER,
    pop_nh_asian INTEGER,
    pop_nh_apasian INTEGER,
    pop_nh_hawaii_pi INTEGER,
    pop_nh_aphawaii_pi INTEGER,
    pop_nh_other_single_race INTEGER,
    pop_nh_multiracial INTEGER,
    vap_total INTEGER,
    vap_white INTEGER,
    vap_black INTEGER,
    vap_apblack INTEGER,
    vap_multiracial_black INTEGER,
    vap_black_black_white INTEGER,
    vap_amind_aknative INTEGER,
    vap_apamind_aknative INTEGER,
    vap_asian INTEGER,
    vap_apasian INTEGER,
    vap_hawaii_pi INTEGER,
    vap_aphawaii_pi INTEGER,
    vap_other_single_race INTEGER,
	vap_multiracial INTEGER,
    vap_hispanic INTEGER,
    vap_nh_white INTEGER,
    vap_nh_black INTEGER,
    vap_nh_apblack INTEGER,
    vap_nh_black_white INTEGER,
    vap_nh_multiracial_black INTEGER,
    vap_nh_amind_aknative INTEGER,
    vap_nh_apamind_aknative INTEGER,
    vap_nh_asian INTEGER,
    vap_nh_apasian INTEGER,
    vap_nh_hawaii_pi INTEGER,
    vap_nh_aphawaii_pi INTEGER,
    vap_nh_other_single_race INTEGER,
    vap_nh_multiracial INTEGER,
    pop_group_quarters_total INTEGER,
    pop_correctional INTEGER,
    pop_juvenile INTEGER,
    pop_nursing INTEGER,
    pop_other_inst INTEGER,
    pop_university INTEGER,
    pop_military INTEGER,
    pop_other_noninst INTEGER,
    pct_pop_white REAL,
    pct_pop_black REAL,
    pct_pop_apblack REAL,
    pct_pop_amind_aknative REAL,
    pct_pop_apamind_aknative REAL,
    pct_pop_asian REAL,
    pct_pop_apasian REAL,
    pct_pop_hawaii_pi REAL,
    pct_pop_aphawaii_pi REAL,
    pct_pop_other_single_race REAL,
    pct_pop_multiracial REAL,
    pct_pop_hispanic REAL,
    pct_pop_nh_white REAL,
    pct_pop_nh_black REAL,
    pct_pop_nh_apblack REAL,
    pct_pop_nh_amind_aknative REAL,
    pct_pop_nh_apamind_aknative REAL,
    pct_pop_nh_asian REAL,
    pct_pop_nh_apasian REAL,
    pct_pop_nh_hawaii_pi REAL,
    pct_pop_nh_aphawaii_pi REAL,
    pct_pop_nh_other_single_race REAL,
    pct_pop_nh_multiracial REAL,
    pct_vap_white REAL,
    pct_vap_black REAL,
    pct_vap_apblack REAL,
    pct_vap_amind_aknative REAL,
    pct_vap_apamind_aknative REAL,
    pct_vap_asian REAL,
    pct_vap_apasian REAL,
    pct_vap_hawaii_pi REAL,
    pct_vap_aphawaii_pi REAL,
    pct_vap_other_single_race REAL,
    pct_vap_multiracial REAL,
    pct_vap_hispanic REAL,
    pct_vap_nh_white REAL,
    pct_vap_nh_black REAL,
    pct_vap_nh_apblack REAL,
    pct_vap_nh_amind_aknative REAL,
    pct_vap_nh_apamind_aknative REAL,
    pct_vap_nh_asian REAL,
    pct_vap_nh_apasian REAL,
    pct_vap_nh_hawaii_pi REAL,
    pct_vap_nh_aphawaii_pi REAL,
    pct_vap_nh_other_single_race REAL,
    pct_vap_nh_multiracial REAL,
    pct_pop_group_quarters_total REAL,
    pct_pop_correctional REAL,
    pct_pop_juvenile REAL,
    pct_pop_nursing REAL,
    pct_pop_other_inst REAL,
    pct_pop_university REAL,
    pct_pop_military REAL,
    pct_pop_other_noninst REAL
"""

cvap_create_fields = """
    cvap_{acs_longyear}_total REAL,
    cvap_{acs_longyear}_nonhispanic REAL,
    cvap_{acs_longyear}_hispanic REAL,
    cvap_{acs_longyear}_amind_aknative REAL,
    cvap_{acs_longyear}_asian REAL,
    cvap_{acs_longyear}_black REAL,
    cvap_{acs_longyear}_hawaii_pi REAL,
    cvap_{acs_longyear}_nh_white REAL,
    cvap_{acs_longyear}_amind_aknative_white REAL,
    cvap_{acs_longyear}_asian_white REAL,
    cvap_{acs_longyear}_black_white REAL,
    cvap_{acs_longyear}_amind_aknative_black REAL,
    cpop_{acs_longyear}_total REAL,
    cpop_{acs_longyear}_nonhispanic REAL,
    cpop_{acs_longyear}_hispanic REAL,
    cpop_{acs_longyear}_amind_aknative REAL,
    cpop_{acs_longyear}_asian REAL,
    cpop_{acs_longyear}_black REAL,
    cpop_{acs_longyear}_hawaii_pi REAL,
    cpop_{acs_longyear}_nh_white REAL,
    cpop_{acs_longyear}_amind_aknative_white REAL,
    cpop_{acs_longyear}_asian_white REAL,
    cpop_{acs_longyear}_black_white REAL,
    cpop_{acs_longyear}_amind_aknative_black REAL,
    pct_cvap_{acs_longyear}_nonhispanic REAL,
    pct_cvap_{acs_longyear}_hispanic REAL,
    pct_cvap_{acs_longyear}_amind_aknative REAL,
    pct_cvap_{acs_longyear}_asian REAL,
    pct_cvap_{acs_longyear}_black REAL,
    pct_cvap_{acs_longyear}_hawaii_pi REAL,
    pct_cvap_{acs_longyear}_nh_white REAL,
    pct_cvap_{acs_longyear}_amind_aknative_white REAL,
    pct_cvap_{acs_longyear}_asian_white REAL,
    pct_cvap_{acs_longyear}_black_white REAL,
    pct_cvap_{acs_longyear}_amind_aknative_black REAL,
    pct_cpop_{acs_longyear}_nonhispanic REAL,
    pct_cpop_{acs_longyear}_hispanic REAL,
    pct_cpop_{acs_longyear}_amind_aknative REAL,
    pct_cpop_{acs_longyear}_asian REAL,
    pct_cpop_{acs_longyear}_black REAL,
    pct_cpop_{acs_longyear}_hawaii_pi REAL,
    pct_cpop_{acs_longyear}_nh_white REAL,
    pct_cpop_{acs_longyear}_amind_aknative_white REAL,
    pct_cpop_{acs_longyear}_asian_white REAL,
    pct_cpop_{acs_longyear}_black_white REAL,
    pct_cpop_{acs_longyear}_amind_aknative_black REAL
"""

block_create_fields = """
        fid INTEGER PRIMARY KEY,
        {geoid_field} TEXT UNIQUE NOT NULL,
        statefp{pl_shortyear} TEXT NOT NULL,
        countyfp{pl_shortyear} TEXT NOT NULL,
        tractce{pl_shortyear} TEXT NOT NULL,
        blockce{pl_shortyear} TEXT NOT NULL,
        blkgrp TEXT NOT NULL,
        vtd TEXT NOT NULL,
        cousub TEXT,
        place TEXT
"""

county_create_fields = """
        fid INTEGER PRIMARY KEY,
        {geoid_field} TEXT UNIQUE NOT NULL,
        statefp{pl_shortyear} TEXT NOT NULL,
        countyfp{pl_shortyear} TEXT NOT NULL,
        name{pl_shortyear} TEXT
"""

tract_create_fields = """
    fid INTEGER PRIMARY KEY,
    {geoid_field} TEXT UNIQUE NOT NULL,
    statefp{pl_shortyear} TEXT NOT NULL,
    countyfp{pl_shortyear} TEXT NOT NULL,
    tractce{pl_shortyear} TEXT NOT NULL,
    name{pl_shortyear} TEXT
"""

blkgrp_create_fields = """
    fid INTEGER PRIMARY KEY,
    {geoid_field} TEXT UNIQUE NOT NULL,
    statefp{pl_shortyear} TEXT NOT NULL,
    countyfp{pl_shortyear} TEXT NOT NULL,
    tractce{pl_shortyear} TEXT NOT NULL,
    blkgrpce{pl_shortyear} TEXT
"""

vtd_create_fields = """
        fid INTEGER PRIMARY KEY,
        {geoid_field} TEXT UNIQUE NOT NULL,
        statefp{pl_shortyear} TEXT NOT NULL,
        countyfp{pl_shortyear} TEXT NOT NULL,
        vtdst{pl_shortyear} TEXT NOT NULL,
        vtdi{pl_shortyear} TEXT NOT NULL,
        name{pl_shortyear} TEXT
"""


def create_sql(geo_type: GeographyType,
               table_name: str, geoid_field: str,
               pl_year: int, incl_acs: bool, acs_year: int = 0):

    if geo_type == GeographyType.BLOCK:
        fields = block_create_fields
    elif geo_type == GeographyType.VTD:
        fields = vtd_create_fields
    elif geo_type == GeographyType.COUNTY:
        fields = county_create_fields
    elif geo_type == GeographyType.TRACT:
        fields = tract_create_fields
    elif geo_type == GeographyType.BLKGRP:
        fields = blkgrp_create_fields
    else:
        fields = """fid INTEGER PRIMARY KEY,
            {geoid_field} TEXT UNIQUE NOT NULL,
            statefp{pl_shortyear} TEXT NOT NULL,
            name{pl_shortyear} TEXT
        """
    fields = f'{fields}, {pop_create_fields}'
    if incl_acs and acs_year:
        fields = f'{fields}, {cvap_create_fields}'
    fields = fields.format(geoid_field=geoid_field, pl_shortyear=str(
        pl_year)[2:], acs_shortyear=str(acs_year)[2:], acs_longyear=str(acs_year))

    return f'CREATE TABLE {table_name} ({fields})'
